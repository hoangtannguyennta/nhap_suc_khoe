<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Th·∫©m ƒê·ªãnh Ch·ªâ S·ªë</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f9f9f9;
      padding: 40px;
      background-image: url('suckhoe.png');
      background-repeat: no-repeat;
      background-size: cover;
      background-position: center;
    }

    .form-container {
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      color: #007BFF;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      font-weight: bold;
    }

    input[type="number"] {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-top: 5px;
      font-size: 15px;
    }

    button {
      width: 100%;
      padding: 12px;
      margin-top: 20px;
      font-size: 16px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .results {
      margin-top: 30px;
      background: #f1f1f1;
      padding: 20px;
      border-radius: 10px;
    }

    .result-item {
      margin-bottom: 10px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2>Th·∫©m ƒê·ªãnh Ch·ªâ S·ªë Gi·∫£m C√¢n</h2>

    <div class="form-group">
      <label>Chi·ªÅu cao (cm):</label>
      <input type="number" id="height" value="158" />
    </div>
    <div class="form-group">
      <label>C√¢n n·∫∑ng hi·ªán t·∫°i (kg):</label>
      <input type="number" id="weight" value="63" />
    </div>
    <div class="form-group">
      <label>S·ªë ƒëo v√≤ng 2 (cm):</label>
      <input type="number" id="waist2" value="87" />
    </div>
    <div class="form-group">
      <label>S·ªë ƒëo v√≤ng eo (cm):</label>
      <input type="number" id="waist" value="93" />
    </div>
    <div class="form-group">
      <label>S·ªë ƒëo v√≤ng h√¥ng (cm):</label>
      <input type="number" id="hip" value="106" />
    </div>
    <div class="form-group">
      <label>M·ª•c ti√™u gi·∫£m (kg):</label>
      <input type="number" id="target" value="10" />
    </div>

    <button onclick="renderResults()">üí° Xem k·∫øt qu·∫£</button>

    <div class="results" id="results" style="display:none;"></div>

    <button onclick="generateExcel()">üì• T·∫£i Excel</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    function renderResults() {
      const h = +document.getElementById('height').value;
      const w = +document.getElementById('weight').value;
      const w2 = +document.getElementById('waist2').value;
      const waist = +document.getElementById('waist').value;
      const hip = +document.getElementById('hip').value;
      const target = +document.getElementById('target').value;

      const bmi = +(w / ((h / 100) ** 2)).toFixed(1);
      const bmiStatus = bmi >= 25 ? "Th·ª´a c√¢n" : "B√¨nh th∆∞·ªùng";

      const idealWeight = +((h - 100) * 0.9).toFixed(1);

      const whr = +(waist / hip).toFixed(2);
      const whrStatus = whr >= 0.85 ? "Nguy c∆° b·ªánh m√£n t√≠nh cao" : "B√¨nh th∆∞·ªùng";

      let feasibility = "";
      if (target <= 0) feasibility = "Kh√¥ng c·∫ßn gi·∫£m";
      else if (target <= 10) feasibility = "C√≥ th·ªÉ ƒë∆∞·ª£c n·∫øu s·∫µn s√†ng n·ªó l·ª±c";
      else feasibility = "Kh√≥ kh·∫£ thi";

      const estimatedWeeks = Math.round(target / 0.5);

      document.getElementById("results").style.display = "block";
      document.getElementById("results").innerHTML = `
        <div class="result-item"><strong>BMI:</strong> ${bmi} ~ ${bmiStatus}</div>
        <div class="result-item"><strong>C√¢n n·∫∑ng l√Ω t∆∞·ªüng:</strong> ${idealWeight} kg</div>
        <div class="result-item"><strong>WHR:</strong> T·ªâ l·ªá: ${whr} ~ ${whrStatus}</div>
        <div class="result-item"><strong>T√≠nh kh·∫£ thi:</strong> ${feasibility}</div>
        <div class="result-item"><strong>T·ªëc ƒë·ªô gi·∫£m kh·∫£ thi:</strong> T·ª´ 0.32kg ƒë·∫øn 0.95kg m·ªôt tu·∫ßn</div>
        <div class="result-item"><strong>L·ªô tr√¨nh d·ª± ki·∫øn:</strong> ${estimatedWeeks} tu·∫ßn ƒë·ªÉ ƒë·∫°t m·ª•c ti√™u (t·ªëc ƒë·ªô ~0.5kg/tu·∫ßn)</div>
      `;
    }

    function generateExcel() {
      const height = +document.getElementById('height').value;
      const weight = +document.getElementById('weight').value;
      const waist2 = +document.getElementById('waist2').value;
      const waist = +document.getElementById('waist').value;
      const hip = +document.getElementById('hip').value;
      const target = +document.getElementById('target').value;

      const wsData = [
        ['Th√¥ng tin', 'Gi√° tr·ªã'],
        ['Chi·ªÅu cao (cm)', height],
        ['C√¢n n·∫∑ng hi·ªán t·∫°i (kg)', weight],
        ['S·ªë ƒëo v√≤ng 2 (cm)', waist2],
        ['S·ªë ƒëo v√≤ng eo (cm)', waist],
        ['S·ªë ƒëo v√≤ng h√¥ng (cm)', hip],
        ['M·ª•c ti√™u gi·∫£m (kg)', target],
        [''],
        ['BMI', { f: 'ROUND(B3/((B2/100)^2),1)&" ~ "&IF(ROUND(B3/((B2/100)^2),1)>=25,"Th·ª´a c√¢n","B√¨nh th∆∞·ªùng")' }],
        ['C√¢n n·∫∑ng l√Ω t∆∞·ªüng (kg)', { f: 'ROUND((B2-100)*0.9,1)' }],
        ['T·ªâ l·ªá Eo/H√¥ng (WHR)', { f: '"T·ªâ l·ªá: "&ROUND(B5/B6,2)&" ~ "&IF(ROUND(B5/B6,2)>=0.85,"Nguy c∆° b·ªánh m√£n t√≠nh cao","B√¨nh th∆∞·ªùng")' }],
        ['T√≠nh kh·∫£ thi', { f: 'IF(B7<=0,"Kh√¥ng c·∫ßn gi·∫£m",IF(B7<=10,"C√≥ th·ªÉ ƒë∆∞·ª£c n·∫øu s·∫µn s√†ng n·ªó l·ª±c","Kh√≥ kh·∫£ thi"))' }],
        ['T·ªëc ƒë·ªô gi·∫£m c√¢n kh·∫£ thi', 'T·ª´ 0.32kg ƒë·∫øn 0.95kg m·ªôt tu·∫ßn'],
        ['L·ªô tr√¨nh d·ª± ki·∫øn', { f: 'ROUND(B7/0.5,0)&" tu·∫ßn ƒë·ªÉ ƒë·∫°t m·ª•c ti√™u (t·ªëc ƒë·ªô ~0.5kg/tu·∫ßn)"' }]
      ];

      const ws = XLSX.utils.aoa_to_sheet(wsData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Th·∫©m ƒë·ªãnh');
      XLSX.writeFile(wb, 'Bang_Tham_Dinh_Giam_Can.xlsx');
    }
  </script>
</body>
</html>