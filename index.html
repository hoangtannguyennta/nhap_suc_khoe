<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>B·∫£ng Th·∫©m ƒê·ªãnh Ch·ªâ S·ªë Gi·∫£m C√¢n</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f2f2f2;
      padding: 40px;
      color: #333;
    }

    h2 {
      text-align: center;
      color: #007BFF;
      margin-bottom: 30px;
    }

    .form-container {
      max-width: 500px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
    }

    input[type="number"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
    }

    button {
      width: 100%;
      padding: 12px;
      background-color: #007BFF;
      color: white;
      border: none;
      font-size: 16px;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <h2>Th·∫©m ƒê·ªãnh Ch·ªâ S·ªë Gi·∫£m C√¢n</h2>
  <div class="form-container">
    <div class="form-group">
      <label for="height">Chi·ªÅu cao (cm):</label>
      <input type="number" id="height" value="158" />
    </div>
    <div class="form-group">
      <label for="weight">C√¢n n·∫∑ng hi·ªán t·∫°i (kg):</label>
      <input type="number" id="weight" value="63" />
    </div>
    <div class="form-group">
      <label for="waist2">S·ªë ƒëo v√≤ng 2 (cm):</label>
      <input type="number" id="waist2" value="87" />
    </div>
    <div class="form-group">
      <label for="waist">S·ªë ƒëo v√≤ng eo (cm):</label>
      <input type="number" id="waist" value="93" />
    </div>
    <div class="form-group">
      <label for="hip">S·ªë ƒëo v√≤ng h√¥ng (cm):</label>
      <input type="number" id="hip" value="106" />
    </div>
    <div class="form-group">
      <label for="target">M·ª•c ti√™u gi·∫£m (kg):</label>
      <input type="number" id="target" value="10" />
    </div>
    <button onclick="generateExcel()">üì• T·∫£i Excel</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    function generateExcel() {
      const height = +document.getElementById('height').value;
      const weight = +document.getElementById('weight').value;
      const waist2 = +document.getElementById('waist2').value;
      const waist = +document.getElementById('waist').value;
      const hip = +document.getElementById('hip').value;
      const target = +document.getElementById('target').value;

      const wsData = [
        ['Th√¥ng tin', 'Gi√° tr·ªã'],
        ['Chi·ªÅu cao (cm)', height],
        ['C√¢n n·∫∑ng hi·ªán t·∫°i (kg)', weight],
        ['S·ªë ƒëo v√≤ng 2 (cm)', waist2],
        ['S·ªë ƒëo v√≤ng eo (cm)', waist],
        ['S·ªë ƒëo v√≤ng h√¥ng (cm)', hip],
        ['M·ª•c ti√™u gi·∫£m (kg)', target],
        [''],
        ['BMI', { f: 'ROUND(B3/((B2/100)^2),1)&" ~ "&IF(ROUND(B3/((B2/100)^2),1)>=25,"Th·ª´a c√¢n","B√¨nh th∆∞·ªùng")' }],
        ['C√¢n n·∫∑ng l√Ω t∆∞·ªüng (kg)', { f: 'ROUND((B2-100)*0.9,1)' }],
        ['T·ªâ l·ªá Eo/H√¥ng (WHR)', { f: '"T·ªâ l·ªá: "&ROUND(B5/B6,2)&" ~ "&IF(ROUND(B5/B6,2)>=0.85,"Nguy c∆° b·ªánh m√£n t√≠nh cao","B√¨nh th∆∞·ªùng")' }],
        ['T√≠nh kh·∫£ thi', { f: 'IF(B7<=0,"Kh√¥ng c·∫ßn gi·∫£m",IF(B7<=10,"C√≥ th·ªÉ ƒë∆∞·ª£c n·∫øu s·∫µn s√†ng n·ªó l·ª±c","Kh√≥ kh·∫£ thi"))' }],
        ['T·ªëc ƒë·ªô gi·∫£m c√¢n kh·∫£ thi', 'T·ª´ 0.32kg ƒë·∫øn 0.95kg m·ªôt tu·∫ßn'],
        ['L·ªô tr√¨nh d·ª± ki·∫øn', { f: 'ROUND(B7/0.5,0)&" tu·∫ßn ƒë·ªÉ ƒë·∫°t m·ª•c ti√™u (t·ªëc ƒë·ªô ~0.5kg/tu·∫ßn)"' }]
      ];

      const ws = XLSX.utils.aoa_to_sheet(wsData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Th·∫©m ƒë·ªãnh');

      XLSX.writeFile(wb, 'Bang_Tham_Dinh_Giam_Can.xlsx');
    }
  </script>
</body>
</html>